<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="custom.css">
    <title>Crear Orden de Trabajo</title>
   

    <script>
        function submitForm(event) {
            event.preventDefault(); // Evita el envío del formulario por defecto

            const formData = {
                patente: document.getElementById("patente").value,
                marca: document.getElementById("marca").value,
                modelo: document.getElementById("modelo").value,
                detalleFalla: document.getElementById("detalleFalla").value,
                horasTrabajadas: parseInt(document.getElementById("horasTrabajadas").value),
                estado: document.getElementById("estado").value,
                empleado: {
                    id: parseInt(document.getElementById("empleadoId").value)
                },
                propietario: {
                    dni: document.getElementById("propietarioDni").value,
                    nombre: document.getElementById("propietarioNombre").value,
                    apellido: document.getElementById("propietarioApellido").value,
                    telefono: document.getElementById("propietarioTelefono").value,
                    direccion: document.getElementById("propietarioDireccion").value
                },
                repuestosUtilizados: []
            };

            // Obtener los repuestos utilizados si es necesario (puedes añadir campos dinámicos)
            // Aquí puedes añadir lógica para recoger los repuestos utilizados, si decides implementarlo

            fetch('/api/ordenes', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
            .then(response => {
                if (response.ok) {
                    alert("Orden creada exitosamente!");
                    // Redirigir a otra página o actualizar la lista
                } else {
                    alert("Error al crear la orden.");
                }
            })
            .catch(error => console.error('Error:', error));
        }
    </script>
</head>
<body>
    <h1>Crear Orden de Trabajo</h1>
    <form onsubmit="submitForm(event)">
        <label for="patente">Patente:</label>
        <input type="text" id="patente" required /><br/>

        <label for="marca">Marca:</label>
        <input type="text" id="marca" required /><br/>

        <label for="modelo">Modelo:</label>
        <input type="text" id="modelo" required /><br/>

        <label for="detalleFalla">Detalle de la Falla:</label>
        <textarea id="detalleFalla" required></textarea><br/>

        <label for="horasTrabajadas">Horas Trabajadas:</label>
        <input type="number" id="horasTrabajadas" required /><br/>

        <label for="estado">Estado:</label>
        <select id="estado" required>
            <option value="ACTIVO">Activo</option>
            <option value="FINALIZADO">Finalizado</option>
        </select><br/>

        <label for="empleadoId">ID del Empleado:</label>
        <input type="number" id="empleadoId" required /><br/>

        <h3>Propietario</h3>
        <label for="propietarioDni">DNI:</label>
        <input type="text" id="propietarioDni" required /><br/>

        <label for="propietarioNombre">Nombre:</label>
        <input type="text" id="propietarioNombre" required /><br/>

        <label for="propietarioApellido">Apellido:</label>
        <input type="text" id="propietarioApellido" required /><br/>

        <label for="propietarioTelefono">Teléfono:</label>
        <input type="text" id="propietarioTelefono" required /><br/>

        <label for="propietarioDireccion">Dirección:</label>
        <input type="text" id="propietarioDireccion" required /><br/>

        <input type="submit" value="Crear Orden" />
    </form>
</body>
</html>
